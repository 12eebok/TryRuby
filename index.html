<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<BASE HREF="/">

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>try ruby! (in your browser)</title>
    <script type="text/javascript" src="js/prototype.js"></script>
    <script type="text/javascript" src="js/mouseApp.js"></script>
    <script type="text/javascript" src="js/mouseIrb.js"></script>
    <script type="text/javascript" src="js/moo.fx.js"></script>
    <script type="text/javascript" src="js/moo.fx.pack.js"></script>
    <script type="text/javascript">
    var allStretch;
    var helpPages;
    var chapPages;
    var defaultPage;
    var toot = window.location.search.substr(1)

    //the main function, call to the effect object
    function dumpAlert(obj) {
        props = [];
        for ( var i in obj ) {
            props.push( "" + i + ": " + obj[i] );
        }
        alert( props );
    }
    window.onload = function() {
        Element.cleanWhitespace('helpstone');
        defaultPage = $('helpstone').childNodes[0].innerHTML;

        window.irb = new MouseApp.Irb('irb', {
            rows: 13,
            name: 'IRB',
            input: 'irb_input',
            greeting: "%+r Interactive ruby ready. %-r",
            ps: '\033[0;32m>>\033[m',
            user: 'guest',
            host: 'tryruby',
            irbUrl: '/irb',
            init: function () {
                Element.cleanWhitespace('helpstone');
                helpPages = document.getElementsByClassName("stretcher");
                chapPages = new Array();
                allStretch = new fx.MultiFadeSize(helpPages, {duration: 400});
                for (var i = 0; i < helpPages.length; i++ ) {
                    var cls = helpPages[i].className.split(' ');
                    for (var j = 0; j < cls.length; j++) {
                        if (cls[j] == 'chapmark') {
                            chapPages.push([i, helpPages[i]]);
                            break;
                        }
                    }
                    allStretch.hide(helpPages[i], 'height');
                }
                helpPages[0].fs.toggle('height');
            },
            loadTutorial: function (id, instruct) {
                new Ajax.Request('/tutorials/' + id + '.html', {
                    method: 'get', 
                    onSuccess: function (r) {
                        if ( instruct ) { 
                            $('helpstone').innerHTML = "<div class='stretcher chapmark'>" + defaultPage + "</div>" + r.responseText;
                        } else {
                            $('helpstone').innerHTML = r.responseText;
                        }
                        window.irb.init();
                        window.irb.showHelp(0);
                    }
                });
            },
            showChapter: function (n) {
                if (n >= chapPages.length) return;
                allStretch.showThisHideOpen(chapPages[n][1], 100, 'height');
                this.setHelpPage(chapPages[n][0], chapPages[n][1]);
            },
            showHelp: function (n) {
                if (n >= helpPages.length) return;
                allStretch.showThisHideOpen(helpPages[n], 100, 'height');
                this.setHelpPage(n, helpPages[n]);
            },
            popup_goto: function (u) {
                Element.show('lilBrowser');
                $('lilBrowser').style.left = '40px';
                $('lilBrowser').style.top = '40px';
                $('lbIframe').src = u;
            },
            popup_make: function (s) {
                Element.show('lilBrowser');
                $('lilBrowser').style.left = '40px';
                $('lilBrowser').style.top = '40px';
                $('lbIframe').onIframeLoad = function () { 
                    return s;
                };
                $('lbIframe').src = '/blank.html';
            },
            popup_close: function () {
                Element.hide('lilBrowser');
            }
        });

        if ( !toot ) {
            toot = 'intro';
        }
        try {
            window.irb.options.loadTutorial( toot, true );
        } catch (e) {}
    }
    </script>
    <style type="text/css">
        @import 'site.css';
    </style>
</head>
<body>
<div id="container">
    <div id="header"><img src="http://localhost:8888/tryruby/images/header.png" /></div>
    <div id="content">
        <div id="lilBrowser">
            <div id="lbTitlebar">
                <h3 id="lbTitle">A Popup Browser</h3>
                <p id="lbClose">[<a href="javascript:void(window.irb.options.popup_close());">x</a>]</p>
            </div>
            <iframe width="500" height="400" src="about:blank" id="lbIframe"></iframe>
        </div>
        <div id="shellwin">
        <div id="terminal">
            <div id="irb"></div>
        </div>
        </div>
        <div id="helpstone">
            <div class="stretcher chapmark">
                <h3>Got 15 minutes? Give Ruby a shot right now!</h3>
                <p>Ruby is a programming language from Japan 
                   (available at <a href="http://ruby-lang.org" target="_new">ruby-lang.org</a>)
                   which is revolutionizing the web.
                   The beauty of Ruby is found in its balance between simplicity and power.</p>
                <p>Try out Ruby code in the prompt above.  In addition
                   to Ruby's builtin methods, the following commands are available:</p>
                <ul class="commands">
                   <li><strong>help</strong>
                       Start the 15 minute interactive tutorial.  Trust me, it's very basic!</li>
                   <li><strong>help 2</strong>
                       Hop to chapter two.</li>
                   <li><strong>clear</strong>
                       Clear screen.  Useful if your browser starts slowing down.
                       Your command history will be remembered.</dd>
                   <li><strong>back</strong>
                       Go back one screen in the tutorial.</li>
                   <li><strong>reset</strong>
                       Reset the interpreter if you get too deep. (or <b>Ctrl-D</b>!)</li>
                   <li><strong>time</strong>
                       A stopwatch.  Prints the time your session has been open.</li>
                </ul>
                <p>If you happen to leave or refresh the page, your session will still be here for
                unless it is left inactive for ten minutes.</p>
                <br />
                <div class="answer"></div>
            </div>
            <div class="note">Trapped in double dots?  A quote or something was left open.  Type: <strong>reset</strong> or hit <strong>Ctrl-D</strong>.</div>
        </div>
    </div>
    <div id="footer"><img src="http://localhost:8888/tryruby/images/footer.png" /></div>
    <p>This place was sired by <a href="http://whytheluckystiff.net">why the lucky stiff</a>.
       Please contact me using the email address at that link.
       And if you'd like to dig into Ruby further, 
       I'm writing an obscure book:
       <em><a href="http://poignantguide.net/">Why's (Poignant) Guide to Ruby</a></em>.</p>
</div>
<input class="keyboard-selector-input" type="text" id="irb_input" autocomplete="off" />
</body>

</html>